<!DOCTYPE html>
<html>

	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<meta charset="utf-8" />
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/common.css" />
		<link rel="stylesheet" type="text/css" href="css/index.css" />
		<script src="js/jquery-3.3.1.min.js" type="text/javascript"></script>
		<script src="js/jquery.simplyscroll.js" type="text/javascript"></script>
		<style>
			.simply-scroll-container { /* Container DIV - automatically generated */
				position: relative;
			}
			.simply-scroll-clip { /* Clip DIV - automatically generated */
				position: relative;
				overflow: hidden;
			}
			.simply-scroll { /* Customisable base class for style override DIV */
				width: 100%;
				height: auto;
				margin-bottom: 1em;
			}
			.simply-scroll .simply-scroll-clip {
				width: 100%;
				height: auto;
			}
			.fullScreen{
				width: 100vw;
				height: 100vh;
				position: fixed;
				top: 0;
				left: 0;
				background: #000;
				z-index:999;
			}
			.fullScreen .fullScreen-video{
				width: 100%;
				height: 74vh;
				overflow: hidden;
				position:relative;
			}
			.fullScreen .fullScreen-buyBtn{
				width:400px;
				height:150px;
				position:absolute;
				bottom:0;
				left:36%;
			}
			.fullScreen .fullScreen-product{
				width: 100%;
				float: left;
				height: 26vh;
				position: absolute;
				bottom: 0;
				background: #fff;
			}
			.fullScreen-product{
				width: 100%;
				padding: 0 1vw;
				height: calc(100% - 8vh);
				display: inline-block;
				overflow-y: hidden;
				-webkit-overflow-scrolling: touch;
			}
			.fullScreen-product ul{
				width: 100%;
				display: inline-block;
			}
			.fullScreen-product ul li{
				width: calc(33.33vw - 2vw);
				margin: 2vw 1vw 0 1vw;
				float: left;
				background: #62cced;
				padding: 1vw;
				border-radius: 2vw;
				border: 0.2vw solid #40aed3;
			}
			.fullScreen-product ul li.liColor{
				box-shadow: 2vw 2vw 6vw #CCCCCC;
				background: #95e6f9;
			}
			.productlist ul li .listimg{
				width: 100%;
				float: left;
			}
			.fullScreen-product ul li .listimg img{
				width: 100%;
				float: left;
				border-radius: 2vw;
			}
			.fullScreen-product ul li .listtext{
				width: 100%;
				display: inline-block;
			}
			.fullScreen-product ul li .listtext div{
				width: 7vw;
				height: 7vw;
				border-radius:50%;
				background: #fff;
				font-size: 0.8rem;
				color: #333;
				line-height: 7vw;
				text-align: center;
				float: right;
				margin-top: -3vw;
			}
			.fullScreen-product ul li .listtext h4{
				font-size: 0.8rem;
				color: #21206c;
				width: 100%;
				float: left;
				margin-top: 1vw;
				overflow: hidden;
				text-overflow:ellipsis;
				white-space: nowrap;
			}
			.fullScreen-product ul li .listtext span{
				display: inline-block;
				font-size: 0.8rem;
				color: #21206c;
				width: calc(100% - 8vw);
				float: left;
			}
			.fullScreen-product ul li .listtext  a{
				color: #8a429f;
				width: calc(100% - 8vw);
				font-size: 0.8rem;
				display: inline-block;
			}
			///////////轮播图///////////
			  *{padding: 0; margin: 0}
			  .slider {
			    position: relative;
			    height: 400px;
			    min-width: 1004px;
			    width: 100%;
			    overflow: hidden;
			  }
			  .slider .slider-pointer {
			    position: absolute;
			    bottom: 20px;
			    color: #fff;
			    list-style: none;
			    padding: 0;
			    z-index: 999;
			  }
			  .slider .slider-pointer li {
			    display: inline-block;
			    margin: 0 15px;
			    width: 15px;
			    height: 15px;
			    border-radius: 15px;
			    background-color: #ffffff;
			    opacity: 0.85;
			    box-shadow: 0 0 2px 2px rgba(0, 0, 0, 0.5);
			    transition: all 320ms ease;
			  }
			  .slider .slider-pointer li:hover {
			    background-color: #e30006;
			  }
			  .slider .slider-pointer li.active {
			    background-color: #b00005;
			  }
			  .slider .slider-inner {
			    width: 100%;
			    height: 100%;
			    position: relative;
			  }
			  .slider .slider-inner .item {
			    width: 100%;
			    height: 100%;
			    float: left;
			  }
			  .slider .slider-inner .img {
			    background-position: center top !important;
			    width: 100%;
			    height: 100%;
			  }
			  .slider .slider-control {
			    position: absolute;
			    width: 30px;
			    height: 30px;
			    z-index: 999;
			    border-radius: 30px;
			    text-align: center;
			    font-weight: 900;
			    font-size: 20px;
			    line-height: 30px;
			    background-color: #ffffff;
			    opacity: 0.5;
			    cursor: pointer;
			    top: 40%;
			    box-shadow: 0 0 2px 2px rgba(0, 0, 0, 0.5);
			    transition: all 320ms ease;
			  }
			  .slider .slider-control:hover {
			    opacity: 0.65;
			    background-color: #b00005;
			  }
			  .slider .slider-control:active {
			    opacity: 0.85;
			  }
			  .slider .slider-control.prev {
			    display: none;
			    left: 20px;
			  }
			  .slider .slider-control.next {
			    display: none;
			    right: 20px;
			  }
			  .slider:hover .slider-control.prev {
			    display: block;
			    left: 20px;
			  }
			  .slider:hover .slider-control.next {
			    display: block;
			    right: 20px;
			  }
		</style>
		<script>
		/**
		 * Author         : CheneyLiu
		 * Date           : date
		 * isAuto:        true, 自动播放
		 * transTime:     3000, 自动播放间隔
		 * animateSpeed:  1000,  动画速度
		 * sliderMode:    'slide', 类型//'slide | fade',
		 * pointerControl: true, 指示器开关
		 * pointerEvent:  'click', 指示器类型//'hover' | 'click',
		 * arrowControl:  true, 左右控制
		 */
		;(function($) {
		$.fn.Slider = function(options) {
		  "use strict";
		  var settings = $.extend({
		    isAuto: true,
		    transTime: 4000,
		    animateSpeed: 1000,  
		    sliderMode: 'slide', //'slide | fade',
		    pointerControl: true,
		    pointerEvent: 'click',//'hover' | 'click',
		    arrowControl: true,
		  }, options);
		  var interval;
		  var isAnimating     = false;
		  var $slider         = $(this);
		  var $sliderWrap     = $slider.find('.slider-inner');
		  var sliderCount     = $sliderWrap.find('> .item').length;
		  var sliderWidth     = $slider.width();
		  var currentIndex    = 0;
		
		  var sliderFun = {
		    controlInit: function() {
		      // pointerControl
		      if (settings.pointerControl) {
		        var html = '';
		        html += '<ol class="slider-pointer">';
		        for (var i = 0; i < sliderCount; i++) {
		          if (i == 0) {
		            html += '<li class="active"></li>'
		          }else{
		            html += '<li></li>'
		          }
		        }
		        html += '</ol>'
		        $slider.append(html);
		          // 指示器居中
		        var $pointer = $slider.find('.slider-pointer');
		        $pointer.css({
		          left: '50%',
		          marginLeft: - $pointer.width()/2
		        });
		      }
		      // pointerControl
		      if (settings.arrowControl) {
		        var html = "";
		        html += '<span class="slider-control prev">&lt;</span>';
		        html += '<span class="slider-control next">&gt;</span>'
		        $slider.append(html);
		      }
		      $slider.on('click', '.slider-control.prev', function(event) {
		        sliderFun.toggleSlide('prev');
		      });
		      $slider.on('click', '.slider-control.next', function(event) {
		        sliderFun.toggleSlide('next');
		      });
		    },
		    // slider
		    sliderInit: function() {
		      sliderFun.controlInit();
		      // 模式选择
		      if (settings.sliderMode == 'slide') {
		        // slide 模式
		        $sliderWrap.width(sliderWidth * sliderCount);
		        $sliderWrap.children().width(sliderWidth);
		      }else{
		        // mode 模式
		        $sliderWrap.children().css({
		          'position': 'absolute',
		          'left': 0,
		          'top': 0
		        });
		        $sliderWrap.children().first().siblings().hide();
		      }
		      // 控制事件
		      if (settings.pointerEvent == 'hover') {
		        $slider.find('.slider-pointer > li').mouseenter(function(event) {
		          sliderFun.sliderPlay($(this).index());
		        });
		      }else{
		        $slider.find('.slider-pointer > li').click(function(event) {
		          if (currentIndex != $(this).index()) {
						sliderFun.sliderPlay($(this).index())
					}
		        });
		      }
		      // 自动播放
		      sliderFun.autoPlay();
		    },
		    // slidePlay
		    sliderPlay: function(index) {
		      sliderFun.stop();
		      isAnimating = true;
		      $sliderWrap.children().first().stop(true, true);
		      $sliderWrap.children().stop(true, true);
		      $slider.find('.slider-pointer').children()
		        .eq(index).addClass('active')
		        .siblings().removeClass('active');
		      if (settings.sliderMode == "slide") {
		        // slide
		        if (index > currentIndex) {
		          $sliderWrap.animate({
		        left: '-=' + Math.abs(index - currentIndex) * sliderWidth + 'px'
		    }, settings.animateSpeed, function() {
		        sliderFun.stop();
		        isAnimating = false;
		        sliderFun.autoPlay()
		    });
		        } else if (index < currentIndex) {
		          $sliderWrap.animate({
		            left: '+=' + Math.abs(index - currentIndex) * sliderWidth + 'px'
		          }, settings.animateSpeed, function() {
		            isAnimating = false;
		            sliderFun.autoPlay();
		          });
		        } else {
		          return;
		        }
		      }else{
		        // fade
		        if ($sliderWrap.children(':visible').index() == index) return;
		        $sliderWrap.children().fadeOut(settings.animateSpeed)
		          .eq(index).fadeIn(settings.animateSpeed, function() {
		            isAnimating = false;
		            sliderFun.autoPlay();
		          });
		      }
		      currentIndex = index;
		    },
		    // toggleSlide
		    toggleSlide: function(arrow) {
		      if (isAnimating) {
		        return;
		      }
		      var index;
		      if (arrow == 'prev') {
		        index = (currentIndex == 0) ? sliderCount - 1 : currentIndex - 1;
		        sliderFun.sliderPlay(index);
		      }else if(arrow =='next'){
		        index = (currentIndex == sliderCount - 1) ? 0 : currentIndex + 1;
		        sliderFun.sliderPlay(index);
		      }
		    },
		    // autoPlay
		    autoPlay: function() {
		      if (settings.isAuto) {
		        interval = setInterval(function () {
		          var index = currentIndex;
		          (currentIndex == sliderCount - 1) ? index = 0: index = currentIndex + 1;
		          sliderFun.sliderPlay(index);
		        }, settings.transTime);
		      }else{
		        return;
		      }
		    },
		    //stop
		    stop: function() {
		      clearInterval(interval);
		    },
		  };
		  sliderFun.sliderInit();
		}
		})(jQuery);
		//jQuery(document).ready(function($) {
		 // $('#slider').Slider();
		//});
		</script>
	</head>
	<body>
		<section class="fullScreen" id="vvscreen" onclick="hideScreen()" style="display:none">
			<div class="fullScreen-video">
				<video id="fullScreen-videoPlay" poster="./img/background.jpg" src="" data-id="" autoplay="autoplay" style="width: 100%;height:74vh;object-fit: fill"></video>
			
					<image class="fullScreen-buyBtn" src="./img/clickbuy.png" style='z-index:9999;'>
			
			</div>
			
			<div class="fullScreen-product">
				<ul id="scroller">
						 
				</ul>
			</div>
		</section>
		<div class="head" style="height: 21.5vh;">
    		 <div class="slider" id="slider">
			  <div class="slider-inner" id="lbPicture">
				    
			  </div>
			</div>
		</div>
		<iframe  id="productView" src="./product.html" style="height: 78.5vh;position: relative;z-index: 1" name="productFrame"></iframe>
		<!--<audio id="bgmMusic" src="video/buy.mp3" autoplay="autoplay"  preload="auto" type="audio/mp3"></audio>-->
	</body>
</html>

<script>
	 $(function () {
		 setTimeout(videoPlay,500);
	     updateCount("1");
	})
	function dgCh(code)
	{
		return local_obj.dgCh(code);
	}
	//当点击产品的时候判断是否有库存
	function testKC(productID,dgOrderDetailID)
	{
		return local_obj.testKC(productID,dgOrderDetailID);
	}
	//记录点击屏幕的时间
	function addClickTime(val)
	{
		$(".slider-pointer").show();
		local_obj.addClickTime(val);
	}
	//更新产品类别方法
	function updateProductType()
	{
		var htmlVal= local_obj.updateProductType();
		productFrame.window.updateProductTypeUI(htmlVal);
	}
	//扫码后将扫码图改成已扫描
	function codeScanReturn()
	{
		productFrame.window.codeScanReturn();
	}
	//更新产品
	function updatePro(productType,pageNO)
	{
		var htmlVal= local_obj.updatePro(productType,pageNO);
		console.log(htmlVal);
		productFrame.window.updateProductUI(htmlVal);
	}
	//更新竖屏产品
	function updatevPro()
	{
		var htmlVal= local_obj.updatevPro();
		//var htmlVal="<li><div class='listimg'><img src='/storage/emulated/0/asm/image/20190409134414.jpg' /></div><div class='listtext'>	<h4>百草味水果捞什锦味</h4>	<span>¥9.0</span>  <a>会员价￥8.80</a>	<div>	购买	</div></div></li>";
		$("#scroller").html(htmlVal);
		 setTimeout(function(){
		 	$("#scroller").simplyScroll();
		 },0);
	}
	//控制页面跳转 type=1 跳转到倒计时页面  type=2跳转到产品列表页面
	function jumpUrl(type)
	{
		if(type=="1")
		{
			$('#productView').attr('src','./shipment.html');
		}else if(type=="2"){
		    var url= $("#productView").attr("src"); 
		    if(url.indexOf("product")==-1)
		    {
		    	$('#productView').attr('src','./product.html');
		    } 
		}
	}
	//获取机器当前状态
	function  getStatus()
	{
		 return local_obj.getStatus();
	}
	//获取alert状态
	function  getAlertStatus()
	{
		 return local_obj.getAlertStatus();
	}
	function getReqsn(companyID,mechineID,productID,sftj,jsonString,dgOrderDetailID,type)
	{
		 return local_obj.getReqsn(companyID,mechineID,productID,sftj,jsonString,dgOrderDetailID,type);
	}
	
	//更新轮播图
	function videoPlay () {
	  var path= local_obj.videoPlay();
	  $("#lbPicture").html(path)
	  $('#slider').Slider();
	    
	}
	//竖屏视频
	function spvideoPlay () {
	 	var path= local_obj.spvideoPlay();
	    var append="";
		if(path=="")
		{
			append = [{id: 0, src:'./video/sp2.mp4'},{id: 0, src:'./video/sp3.mp4'}]
		}else{
			append=JSON.parse(path);
		}
		$('#fullScreen-videoPlay').attr({'src': append[0].src}).attr({'data-id': append[0].id})
	    $("#fullScreen-videoPlay").on("ended",function(){
            var a = $('#fullScreen-videoPlay').attr('data-id')
            local_obj.uploadVideoRecord(a);
	    	for(var a=0; a<append.length; a++) {
	    		if (append[a].id == $('#fullScreen-videoPlay').attr('data-id')) {
	    			if (a >= append.length - 1) {
	    				$('#fullScreen-videoPlay').attr({'src': append[0].src}).attr({'data-id': append[0].id})
						// a = append[0].id
	    				return false
	    			}
	    			$('#fullScreen-videoPlay').attr({'data-id': append[a + 1].id, 'src': append[a + 1].src})
					// a = append[a + 1].id
	    			break
	    		}
	    	}
	    })
	}
	function showScreen()
	{
		updatevPro();
		spvideoPlay();
		var fullScreenVideoPlay = document.getElementById("fullScreen-videoPlay");
		fullScreenVideoPlay.play();
		var sbtitle= document.getElementById("vvscreen");
		if(sbtitle)
		{
			if(sbtitle.style.display == 'block'|| sbtitle.style.display == '') {
				console.log("showScreen=1");
                sbtitle.style.display = 'none';
               
           } else {
				console.log("showScreen=2");
                sbtitle.style.display = 'block';
                $(".slider-pointer").hide();
           }
		}
		 
	}
	function hideScreen()
	{
		addClickTime("1");
		updateIndex();
		if($("#vvscreen").is(":visible")){
      	 	$("#vvscreen").hide();   //如果元素为隐藏,则将它显现
			var fullScreenVideoPlay = document.getElementById("fullScreen-videoPlay");
			fullScreenVideoPlay.pause();
			
		} 
	}
	function updateIndex()
	{
		local_obj.updateIndex();
	}
	 function getMechineID()
	{
		return local_obj.getMechineID();
	}
	function updateCount(val)
	{
		console.log("vals="+val);
		local_obj.updateCount(val);
	}
	function updateIndexCount()
	{
		local_obj.updateIndexCount();
	}
	function playMp3(val)
	{
		local_obj.playMp3(val);
	}
</script>